## Study Section "Feed" – Product Spec

### Goal
Introduce a new **Study Feed** section where users can view, manage, and create reusable study items (flashcard sets, study guides, practice tests). These items can be created manually or generated by AI (via chat requests, uploaded documents, or prompts), and are surfaced both in the Feed and through chatbot interactions.

### Study Item Types
- **Flashcard Set**
  - Front/back cards with rich text and math support.
  - Optional tags (topic, course, difficulty, exam type).
- **Study Guide**
  - Structured outline with headings, bullet points, key formulas, and summaries.
  - Optional sections for examples and tips.
- **Practice Test**
  - Collection of questions with answer keys and rationales.
  - Support for multiple choice, free response, and true/false.

All study items share:
- **Core metadata**: title, description, type, subject, tags, createdBy, createdAt, updatedAt, source (manual | ai-prompt | ai-doc | chatbot-request).
- **Visibility**: private by default; future-ready for shared/public modes.

### New Pages / Navigation
- **Study Feed Page**
  - Entry point under a new `Study` or `Feed` nav item.
  - Shows a feed of study items (all types) sorted by most recently updated.
  - Filter + search:
    - Filter by type (Flashcards, Study Guides, Practice Tests).
    - Filter by tag/subject.
    - Search by title/description.
  - Quick actions on each item:
    - Open / Continue Studying.
    - Edit (if owner).
    - Duplicate (create a new editable copy).

- **Study Item Detail Page**
  - Route pattern: `/study/:itemId`.
  - Shows the item content plus metadata, last updated timestamp, and source.
  - Contextual actions:
    - Edit (if owner).
    - Duplicate.
    - Send to Chat (opens chat preloaded with a prompt referencing this item).

- **Create Study Item Flow**
  - Accessed from:
    - "Create Study Item" button on Study Feed.
    - Chatbot when user requests a study item (see chatbot behavior below).
  - Step 1: **Choose Type**
    - Flashcard Set, Study Guide, Practice Test.
  - Step 2: **Choose Creation Method**
    - Manual build in a form editor.
    - AI from prompt.
    - AI from uploaded documents (PDFs, notes, slides, etc.).
  - Step 3: **Configure**
    - Basic metadata: title, subject, tags, difficulty, description.
    - For AI-based methods: prompt and/or document selection + generation options (length, difficulty, number of questions/cards).
  - Step 4: **Generate & Review**
    - If manual: save directly into Feed.
    - If AI: show preview, allow inline editing before final save.

### Chatbot Integration – Generation UX

When the user requests a study item from the chatbot (e.g. "Make me a flashcard set for Chapter 3" or "Create a practice test from this PDF"), the behavior should be:

- **Bot response pattern**
  - Instead of sending the entire item in chat, the bot replies with:
    - Text: `Generating [Study Item Type] Now...`
    - A **loading bar / progress indicator** component.
  - The generation runs asynchronously; the chat remains usable while the item is being created.

- **Generation completion**
  - Once the item is ready:
    - The chat posts a follow-up message, e.g.:
      - "Your `[Study Item Type]` is ready in your Study Feed."
    - Include a **deep link** to the created item detail page (e.g. `/study/:itemId`).
    - Optionally show a small structured preview (title and a few bullets/cards), but keep the full experience in the Study Feed UI.

- **Supported chatbot creation paths**
  - **Prompt-based generation**:
    - User directly asks for "flashcards", "study guide", "practice test", etc.
  - **Document-based generation**:
    - User uploads or references documents in chat and asks to generate study items from them.
  - **Manual redirect**:
    - If the user says "I want to build my own flashcards", the bot can respond with:
      - "You can create them directly in the Study Feed."
      - Provide a link to the Create Study Item flow with the type pre-selected.

All of these paths must create **the same underlying study item models** used by the Study Feed, with a `source` field marking how they were created.

### Creation Methods (Unified Model)

Regardless of how an item is created, it should end up as a uniform structure in storage:
- **Manual editor**
  - Web forms for each type (card list, outline editor, test question editor).
  - Saves directly to the study items collection.

- **AI generation from prompt**
  - Chatbot or Study Feed UI passes:
    - Item type.
    - User prompt/context.
    - Desired size/difficulty and any other options.
  - Backend pipeline generates a draft item, stores it, and marks the `source = "ai-prompt"`.

- **AI generation from documents**
  - User uploads or selects existing documents (or references docs in chat).
  - Backend ingests the documents and extracts structure.
  - Generates study items according to the selected type + options.
  - Stores items with `source = "ai-doc"` and a reference to the document set.

- **Chatbot-requested items**
  - Chat session includes user query + context (optionally associated docs).
  - Chat agent decides which item type to create.
  - Triggers the same backend generation pipeline as above.
  - Stores items with `source = "chatbot-request"`.

### UX & Visual Considerations
- **Study Feed page**
  - Card-based layout with clear labels for item type.
  - Badges for creation source (e.g., "AI from Docs", "Manual", "From Chatbot").
  - Indicators for "New" items.

- **Loading bar in chat**
  - Inline component that shows:
    - Progress (if trackable) or an indeterminate animation.
    - Optional status text such as "Analyzing your documents...", "Creating questions...", "Finalizing cards...".
  - Should gracefully handle errors (e.g., show "Generation failed. Try again or create manually in the Study Feed." with actions).

### Technical Notes (High-Level)
- **Routing**
  - New routes for:
    - `/study` – Study Feed.
    - `/study/new` – Create Study Item flow (query params for type/method).
    - `/study/:itemId` – Study Item detail.

- **Data model (suggested fields)**
  - `id`
  - `type` (flashcards | studyGuide | practiceTest)
  - `title`
  - `description`
  - `subject`
  - `tags: string[]`
  - `content` (type-specific structure)
  - `source` (manual | ai-prompt | ai-doc | chatbot-request)
  - `createdBy`, `createdAt`, `updatedAt`
  - `linkedChatSessionId?` (if created via chatbot)
  - `linkedDocumentSetId?` (if created from docs)

- **Permissions**
  - Only the owner can edit or delete their items (initially).
  - Read access limited to the owner until sharing is introduced.

### Open Questions / Future Extensions
- Public / shared feeds (e.g., browse community flashcards).
- Collaborative editing of study items.
- Analytics on item usage (e.g., which decks/tests are most used).
- Integrations with spaced repetition or scheduling systems.

